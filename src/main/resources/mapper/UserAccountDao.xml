<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.grand.enoteboot.dao.UserAccountDao">
    <sql id="baseColumn">
        enote_permission.id,
        enote_permission.perm_type permType,
        enote_permission.name,
        enote_permission.url,
        enote_permission.parent_id parentId,
        enote_permission.sort_no sortNo,
        enote_permission.is_leaf isLeaf,
        enote_permission.status,
        enote_permission.description,
        enote_permission.create_id createId,
        enote_permission.create_time createTime,
        enote_permission.update_id updateId,
        enote_permission.update_time updateTime,
        enote_permission.is_delete isDelete
    </sql>
    <!-- 目的：为dao接口方法提供sql语句配置 -->
    <select id="getMenuList" resultType="permission" parameterType="long">
        <!-- 具体的sql -->
        SELECT
        <include refid="baseColumn"/>
        FROM
        enote_permission,enote_role_permission
        WHERE
        enote_role_permission.permission_id = enote_permission.id
        AND enote_role_permission.role_id = #{roleId}
        ORDER BY sort_no
    </select>

    <select id="findUserByUsername" resultType="user" parameterType="string">
        SELECT
        id,
        username,
        password,
        email,
        last_login_time,
        status
        FROM enote_user
        WHERE username = #{username} AND is_deleted = 0
    </select>

    <update id="updateByPrimaryKeySelective" parameterType="com.grand.enoteboot.entity.User">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update enote_user
        <set>
            <if test="username != null">
                username = #{usernameT},
            </if>
            <if test="password != null">
                password = #{password},
            </if>
            <if test="email != null">
                email = #{email},
            </if>
            <if test="createId != null">
                create_id = #{createId},
            </if>
            <if test="createTime != null">
                create_time = #{createTime},
            </if>
            <if test="updateId != null">
                update_id = #{updateId},
            </if>
            <if test="updateTime != null">
                update_time = #{updateTime},
            </if>
            <if test="lastLoginTime != null">
                last_login_time = #{lastLoginTime},
            </if>
            <if test="status != null">
                status = #{status},
            </if>
        </set>
        where id = #{id,jdbcType=BIGINT}
    </update>
</mapper>